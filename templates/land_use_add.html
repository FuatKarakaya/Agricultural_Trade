{% extends "layout.html" %}

{% block title %}Add Land Use Record - Zlatan Agriculture{% endblock %}

{% block content %}
<style>
  .form-page-container {
    max-width: 800px;
    margin: 0 auto;
  }

  .form-section {
    padding: 1rem;
    border-radius: 8px;
    border: 1px solid #ddd;
    background-color: #fafafa;
    margin-top: 1rem;
  }

  .landuse-form {
    margin-top: 0.75rem;
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 12px 24px;
  }

  .landuse-form .form-row {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .landuse-form .form-row-full {
    grid-column: 1 / -1;
  }

  .landuse-form label {
    font-weight: 600;
    font-size: 0.85rem;
  }

  .landuse-form input,
  .landuse-form select {
    padding: 0.3rem 0.5rem;
    font-size: 0.9rem;
    border-radius: 4px;
    border: 1px solid #ccc;
  }

  .landuse-form button {
    margin-top: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background-color: #007bff;
    color: white;
    font-weight: 600;
  }

  .back-link {
    display: inline-block;
    margin-top: 1rem;
    font-size: 0.9rem;
  }
  .flash-container {
    max-width: 900px;
    margin: 1rem auto;
  }

  .flash-message {
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
  }

  .flash-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }

  .flash-error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }

  .unit-note {
    font-size: 0.8rem;
    color: #666;
    margin-top: 2px;
  }
</style>

<div class="form-page-container">
  <h2>Add Land Use Record</h2>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-container">
        {% for category, message in messages %}
          <div class="flash-message flash-{{ category }}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
  <section class="form-section">
    <form method="post" action="{{ url_for('landuse.add_land_use') }}" class="landuse-form" id="landUseForm">
      <!-- Country -->
      <div class="form-row">
        <label for="form-country">Country:</label>
        <select id="form-country" name="country_id" required>
            <option value="">Select a country</option>
            {% for c in countries %}
                <option value="{{ c['country_id'] }}"
                        {% if selected_country_id == c['country_id'] %}selected{% endif %}>
                {{ c['country_name'] }}
                </option>
            {% endfor %}
        </select>
      </div>

      <!-- Year -->
      <div class="form-row">
        <label for="form-year">Year:</label>
        <select id="form-year" name="year" required>
          {% for y in years %}
            <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Unit (seçilebilir) -->
      <div class="form-row form-row-full">
        <label for="form-unit">Unit:</label>
        <select id="form-unit" name="unit" required>
          {% for unit_option in unit_options %}
            <option value="{{ unit_option }}" {% if unit_option == "1000 ha" %}selected{% endif %}>
              {{ unit_option }}
            </option>
          {% endfor %}
        </select>
        <div class="unit-note">All values below will be in the selected unit</div>
      </div>

      <!-- Country area -->
      <div class="form-row">
        <label for="country-area">Country area:</label>
        <input
          id="country-area"
          type="number"
          name="country_area"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 783.56"
        >
      </div>

      <!-- Land area -->
      <div class="form-row">
        <label for="land-area">Land area:</label>
        <input
          id="land-area"
          type="number"
          name="land_area"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 769.63"
        >
      </div>

      <!-- Inland waters -->
      <div class="form-row">
        <label for="inland-waters">Inland waters:</label>
        <input
          id="inland-waters"
          type="number"
          name="inland_waters"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 13.93"
        >
      </div>

      <!-- Arable land -->
      <div class="form-row">
        <label for="arable-land">Arable land:</label>
        <input
          id="arable-land"
          type="number"
          name="arable_land"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 230.00"
        >
      </div>

      <!-- Permanent crops -->
      <div class="form-row">
        <label for="permanent-crops">Permanent crops:</label>
        <input
          id="permanent-crops"
          type="number"
          name="permanent_crops"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 35.40"
        >
      </div>

      <!-- Permanent meadows and pastures -->
      <div class="form-row">
        <label for="permanent-meadows">Permanent meadows and pastures:</label>
        <input
          id="permanent-meadows"
          type="number"
          name="permanent_meadows_and_pastures"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 140.00"
        >
      </div>

      <!-- Forest land -->
      <div class="form-row">
        <label for="forest-land">Forest land:</label>
        <input
          id="forest-land"
          type="number"
          name="forest_land"
          step="0.01"
          min="0"
          required
          placeholder="e.g., 226.50"
        >
      </div>

      <div class="form-row form-row-full">
        <button type="submit">
          Save records
        </button>
      </div>
    </form>
  </section>

  <a href="{{ url_for('landuse.landUsePage', year=year) }}" class="back-link">
    ← Back to Land Use Summary
  </a>
</div>

<script>
  // Unit değiştiğinde validation kurallarını göster (opsiyonel)
  document.getElementById('form-unit').addEventListener('change', function() {
    const selectedUnit = this.value;
    console.log('Selected unit:', selectedUnit);
    // İsterseniz burada bir bilgilendirme mesajı gösterebilirsiniz
  });
</script>

{% endblock %}